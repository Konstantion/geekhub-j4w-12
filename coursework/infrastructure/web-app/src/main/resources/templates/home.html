<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Test</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>
<script>
  let stompClient = null;
  function connect() {
    const userId = document.getElementById('userId').value;
    const socket = new SockJS('/web-api/calls-socket');
    stompClient = Stomp.over(socket);
    stompClient.connect({}, function (frame) {
      console.log('Connected: ' + frame);
      stompClient.subscribe('/topic/calls/user/' + userId, function (message) {
        console.log('Received: ' + message.body);
        const p = document.createElement('div');
        p.innerText = message.body;
        document.querySelector('#messages').append(p);
      });
    });
  }

  function sendMessage() {
    const id = document.getElementById('userId').value;
    const message = document.getElementById('message').value;
    stompClient.send("/app/chat/"+ id, {}, message); // Replace "/app/sendMessage" with the desired message mapping
  }

  function disconnect() {
    if (stompClient !== null) {
      stompClient.disconnect();
    }
    console.log("Disconnected");
  }

  connect();
</script>

<label for="userId"></label>
<input type="text" id="userId" value="" placeholder="Enter user id">
<button onclick="disconnect()">Disconnect</button>
<button onclick="connect()">Connect</button>
<div id="messages"></div>
</body>
</html>